{% extends "base.html" %}

{% block title %}Dashboard | NT TACACS+{% endblock %}
{% block header %}Dashboard Overview{% endblock %}

{% block content %}

<section class="section">
  <h2 class="section-title">System Summary</h2>

  <div class="card-grid">
    <div class="card">
      <div class="card-label">Recent TACACS+ Users</div>
      <div class="card-value">{{ summary.recent_users }}</div>
      <div class="card-sub">จำนวนบัญชีที่มีการ login ล่าสุดเข้าสู่ OLT</div>
    </div>

    <div class="card">
      <div class="card-label">Failed Login Attempts</div>
      <div class="card-value card-value-danger">{{ summary.failed_logins }}</div>
      <div class="card-sub">นับจากเหตุการณ์ login ที่ result=rejected</div>
    </div>

    <div class="card">
      <div class="card-label">Registered OLT Devices (from logs)</div>
      <div class="card-value">{{ summary.devices }}</div>
      <div class="card-sub">นับจาก device ที่พบใน log</div>
    </div>

    <div class="card">
      <div class="card-label">Roles / Privilege Profiles (from logs)</div>
      <div class="card-value">{{ summary.roles }}</div>
      <div class="card-sub">นับจาก role ที่พบใน log</div>
    </div>
  </div>
</section>

<section class="section">
  <h2 class="section-title">Recent Security Events</h2>

  <div class="table-wrapper">
    <table class="table">
      <thead>
        <tr>
          <th>Time</th>
          <th>User</th>
          <th>Role</th>
          <th>Device</th>
          <th>Action</th>
          <th>Result</th>
        </tr>
      </thead>
      <tbody>
        {% for e in events %}
        <tr>
          <td>{{ e.time }}</td>
          <td>{{ e.user }}</td>
          <td>{{ e.role }}</td>
          <td>{{ e.device }}</td>
          <td>{{ e.action }}</td>
          <td class="{{ 'status-ok' if e.result in ['OK','ACCEPT','SUCCESS','PASS'] else 'status-fail' if e.result in ['REJECT','FAIL','ERROR'] else '' }}">
            {{ e.result }}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</section>

{% endblock %}

